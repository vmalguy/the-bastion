

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Security &mdash; The Bastion 3.00.00 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/thebastion.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="The Bastion 3.00.00 documentation" href="../index.html"/>
        <link rel="up" title="Presentation" href="index.html"/>
        <link rel="next" title="Installation &amp; Setup" href="../installation/index.html"/>
        <link rel="prev" title="Features" href="features.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> The Bastion
          

          
          </a>

          
            
            
              <div class="version">
                3.00.00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Presentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="principles.html">Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html">Features</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Security</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#security-principles-at-the-core">Security principles at the core</a></li>
<li class="toctree-l3"><a class="reference internal" href="#auditability">Auditability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation &amp; Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using/index.html">Using the bastion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Bastion plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Bastion</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Presentation</a> &raquo;</li>
        
      <li>Security</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/presentation/security.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="security">
<h1>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h1>
<div class="section" id="security-principles-at-the-core">
<h2>Security principles at the core<a class="headerlink" href="#security-principles-at-the-core" title="Permalink to this headline">¶</a></h2>
<p>Even with the most conservative, precautionous and paranoid coding process, code has bugs, so it shouldn't be trusted blindly. Hence the bastion doesn't trust its own code. It leverages the operating system security primitives to get additional security, as seen below.</p>
<ul>
<li><p class="first">Uses the well-known and trusted UNIX Discretionary Access Control:</p>
<blockquote>
<div><ul class="simple">
<li>Bastion users are mapped to actual system users</li>
<li>Bastion groups are mapped to actual system groups</li>
<li>All the code is constantly checking rights before allowing any action</li>
<li>UNIX DAC is used as a safety belt to prevent an action from succeeding even if the code is tricked into allowing it</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The bastion main script is declared as the bastion user's system shell:</p>
<blockquote>
<div><ul class="simple">
<li>No user has real (<code class="docutils literal"><span class="pre">bash</span></code>-like) shell access on the system</li>
<li>All code is ran under the unprivileged user's system account rights</li>
<li>Even if a user could escape to a real shell, he wouldn't be able to connect to machines he doesn't have access to, because he doesn't have filesystem-level read access to the SSH keys</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">The code is modular</p>
<blockquote>
<div><ul>
<li><p class="first">The main code mainly checks rights, logs actions, and enable <code class="docutils literal"><span class="pre">ssh</span></code> access to other machines</p>
</li>
<li><p class="first">All side commands, called <strong>plugins</strong>, are in modules separated from the main code</p>
</li>
<li><p class="first">The modules can either be <strong>open</strong> or <strong>restricted</strong></p>
<blockquote>
<div><ul class="simple">
<li>Only accounts that have been specifically granted on a need-to-use basis can run a specific restricted plugin</li>
<li>This is checked by the code, and also enforced by UNIX DAC (the plugin is only readable and executable by the system group specific to the plugin)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">All the code needing extended system privileges is separated from the main code, in modules called <strong>helpers</strong></p>
<blockquote>
<div><ul class="simple">
<li>Helpers are run exclusively under <code class="docutils literal"><span class="pre">sudo</span></code></li>
<li>The <code class="docutils literal"><span class="pre">sudoers</span></code> configuration is attached to a system group specific to the command, which is granted to accounts on a need-to-use basis</li>
<li>The helpers are only readable and executable by the system group specific to the command</li>
<li>The helpers path and some of their immutable parameters are hardcoded in the <code class="docutils literal"><span class="pre">sudoers</span></code> configuration</li>
<li>Perl tainted mode (<code class="docutils literal"><span class="pre">-T</span></code>) is used for all code running under <code class="docutils literal"><span class="pre">sudo</span></code>, preventing any user-input to interfere with the logic, by halting execution immediately</li>
<li>Code running under <code class="docutils literal"><span class="pre">sudo</span></code> doesn't trust its caller and re-checks every input</li>
<li>Communication between unprivileged and privileged-code are done using JSON</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="auditability">
<h2>Auditability<a class="headerlink" href="#auditability" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Bastion administrators must use the bastion's logic to connect to itself to administer it (or better, use another bastion to do so), this ensures auditability in all cases</p>
</li>
<li><p class="first">Every access and action (whether allowed or denied) is logged with:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">syslog</span></code>, which should also be sent to a remote syslog server to ensure even bastion administrators can't tamper their tracks, and/or</li>
<li>local <code class="docutils literal"><span class="pre">sqlite3</span></code> databases for easy searching</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">This code is used in production in several PCI-DSS, ISO 27001, SOC1 and SOC2 certified environments</p>
</li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../installation/index.html" class="btn btn-neutral float-right" title="Installation &amp; Setup" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="features.html" class="btn btn-neutral" title="Features" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, OVHcloud.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.00.00',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>