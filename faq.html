

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>FAQ &mdash; The Bastion 3.00.00 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/thebastion.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="The Bastion 3.00.00 documentation" href="index.html"/>
        <link rel="prev" title="groupTransmitOwnership" href="plugins/group-owner/groupTransmitOwnership.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> The Bastion
          

          
          </a>

          
            
            
              <div class="version">
                3.00.00
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="presentation/index.html">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation/index.html">Installation &amp; Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="using/index.html">Using the bastion</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/index.html">Bastion plugins</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-bastion-really">&quot;The Bastion&quot;, really?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#why-using-common-sense">Why using common::sense?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#why-perl">Why Perl?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#why-not-using-a-pki">Why not using a PKI?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-does-osh-mean-in-osh">What does <cite>osh</cite> mean in <code class="docutils literal"><span class="pre">--osh</span></code>?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#what-are-the-recommended-hardware-specifications">What are the recommended hardware specifications?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#can-i-run-it-under-docker-in-production">Can I run it under Docker in production?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#can-i-install-it-on-my-already-existing-server">Can I install it on my already existing server?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-use-the-bastion-with-the-ssh-proxycommand-option">How to use The Bastion with the SSH <code class="docutils literal"><span class="pre">ProxyCommand</span></code> option?</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">The Bastion</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>FAQ</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/faq.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="faq">
<h1>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-bastion-really">
<h2>&quot;The Bastion&quot;, really?<a class="headerlink" href="#the-bastion-really" title="Permalink to this headline">¶</a></h2>
<p>We've been using this software for quite a while at OVHcloud, and there it has always been known as &quot;the bastion&quot;: nobody ever bothered to find a fancy name for it.
So, when we decided to release it in opensource, the naming problem arose.
After going through some possible names, we realized that nothing would work, as everybody would keep naming it &quot;the bastion&quot; anyway, so, we decided to call it just <em>The Bastion</em>.</p>
</div>
<div class="section" id="why-using-common-sense">
<h2>Why using common::sense?<a class="headerlink" href="#why-using-common-sense" title="Permalink to this headline">¶</a></h2>
<p>Because it's usually a good idea to ensure you use common::sense before writing code! On a more serious note, this is almost like using <code class="docutils literal"><span class="pre">strict</span></code> and <code class="docutils literal"><span class="pre">warnings</span></code>, but with a very reduced memory footprint. When you run a bastion with thousands of simultaneous active sessions with that many users, it starts to matter.</p>
</div>
<div class="section" id="why-perl">
<h2>Why Perl?<a class="headerlink" href="#why-perl" title="Permalink to this headline">¶</a></h2>
<p>There is probably and endless list of why it's the perfect language for this, and another similarly endless list of why Perl is completely irrelevant and other $COOL_LANGUAGE would be a better fit, but some &quot;why&quot; reasons include:</p>
<ul class="simple">
<li>It works everywhere, and most OSes have it installed by default</li>
<li>Perl has this cool &quot;taint&quot; mode that adds security to untrusted program inputs, we use this on sensitive code</li>
<li>One of the design choice of The Bastion has always been to be very close to the system, leveraging some low-level Operating System functions, which are easier to interact with using a scripting language</li>
<li>The Bastion has a loose origin from an old script written at OVHcloud in the early days, back when the de-facto usual language used internally was Perl</li>
</ul>
</div>
<div class="section" id="why-not-using-a-pki">
<h2>Why not using a PKI?<a class="headerlink" href="#why-not-using-a-pki" title="Permalink to this headline">¶</a></h2>
<p>Well, you can, of course! However this is a very centralized way of managing your accesses, with all the power in the hands of whoever controls your CA. It can be a highly successful if done very carefully, with a lot of security and processes around the certificates delivery workflows. Managing a CA correctly is no joke and can bite you quite hard if done improperly. This also happens to be a somewhat recent addition to OpenSSH, and if you have a lot of heterogeneous systems to handle, this might be a no-go. You can read more about this topic here: <a class="reference external" href="https://www.ovh.com/blog/the-ovhcloud-bastion-part-1/">https://www.ovh.com/blog/the-ovhcloud-bastion-part-1/</a></p>
</div>
<div class="section" id="what-does-osh-mean-in-osh">
<h2>What does <cite>osh</cite> mean in <code class="docutils literal"><span class="pre">--osh</span></code>?<a class="headerlink" href="#what-does-osh-mean-in-osh" title="Permalink to this headline">¶</a></h2>
<p>This has long been forgotten. Some people say it used to mean &quot;Ovh SHell&quot; at some point, but nobody knows whether it's true or just a legend.</p>
</div>
<div class="section" id="what-are-the-recommended-hardware-specifications">
<h2>What are the recommended hardware specifications?<a class="headerlink" href="#what-are-the-recommended-hardware-specifications" title="Permalink to this headline">¶</a></h2>
<p>They're actually quite low. Down to its basics, the bastion is merely a fancy wrapper around <code class="docutils literal"><span class="pre">ssh</span></code>, so if you have a device that handles <code class="docutils literal"><span class="pre">ssh</span></code> well, it'll handle the bastion just fine.</p>
<p>Now to give you some data points, we've observed that 250 concurrent users take up 2.5 Gb of RAM (including the operating system's own footprint, and the usual daemons such as auditd, syslog, etc.). So a rule of thumb would be 1 Gb per 100 simultaneous sessions. If you expect to get a lot of new connections per minute (not necessarily long-lived), it's advised to use SSD drives however, as the bastion workload pattern for disk I/O is a lot of random seeks to write logs and ttyrecs. Mechanical hard drives are very bad at this.</p>
</div>
<div class="section" id="can-i-run-it-under-docker-in-production">
<h2>Can I run it under Docker in production?<a class="headerlink" href="#can-i-run-it-under-docker-in-production" title="Permalink to this headline">¶</a></h2>
<p>Technically you can, but you have to think about what are the implications (this is true regardless of the containerization technology). What's important to understand is that it adds another layer of abstraction, and can give you a false sense of security. If you either have the complete control of the host running Docker (and hardened it properly), or you fully trust whoever is running the host for you, then this is fine. Otherwise, <em>somebody</em> might have access to all your keys and you have no way to know or block it.</p>
<p>Note that the provided Dockerfiles are a good start, but no volumes are defined. To ensure that all the accounts don't disappear on a <code class="docutils literal"><span class="pre">docker</span> <span class="pre">rm</span></code>, you would at least need to ensure that <code class="docutils literal"><span class="pre">/home</span></code>, <code class="docutils literal"><span class="pre">/etc/passwd</span></code>, <code class="docutils literal"><span class="pre">/etc/shadow</span></code>, <code class="docutils literal"><span class="pre">/etc/group</span></code>, <code class="docutils literal"><span class="pre">/etc/gshadow</span></code> are stored in a volume, in addition to <code class="docutils literal"><span class="pre">/etc/bastion</span></code> and <code class="docutils literal"><span class="pre">/root/.gpg</span></code>. You'll also need an SSH server, obviously, and probably a <code class="docutils literal"><span class="pre">syslog-ng</span></code> daemon.</p>
</div>
<div class="section" id="can-i-install-it-on-my-already-existing-server">
<span id="faq-existing-server"></span><h2>Can I install it on my already existing server?<a class="headerlink" href="#can-i-install-it-on-my-already-existing-server" title="Permalink to this headline">¶</a></h2>
<p>This is discouraged if your server is already doing something else, such as hosting a website, handling your e-mails or running a database.</p>
<p>From a security standpoint, it's a bad idea because if your server gets hacked due to one of the other services you're hosting, the SSH keys could get compromised even if The Bastion itself has no security issue.</p>
<p>This is also discouraged due to the design of The Bastion: being deeply intertwined with the OS it's running on, it might make changes that seem intrusive from the point of view of other running services. Such as creating and deleting system accounts and groups from time to time, modifying the PAM configuration, or hardening the SSH client and server configurations system-wide, which could break other services or workflows that expect to be running on a default (non-hardened) SSH configuration.</p>
</div>
<div class="section" id="how-to-use-the-bastion-with-the-ssh-proxycommand-option">
<span id="faq-jumphost"></span><h2>How to use The Bastion with the SSH <code class="docutils literal"><span class="pre">ProxyCommand</span></code> option?<a class="headerlink" href="#how-to-use-the-bastion-with-the-ssh-proxycommand-option" title="Permalink to this headline">¶</a></h2>
<p><strong>tl;dr</strong>: you can't.</p>
<p><strong>Fast answer</strong>: you can't, because The Bastion is not a proxy, nor what is often called an &quot;ssh jumphost&quot;. Granted, sometimes these are also called &quot;bastions&quot;, hence the confusion. Note that this also applies to the <code class="docutils literal"><span class="pre">-J</span></code> or <code class="docutils literal"><span class="pre">JumpHost</span></code> ssh option, which is just a simplified <code class="docutils literal"><span class="pre">ProxyCommand</span></code>.</p>
<p><strong>Long answer</strong>: The Bastion is acting as a trusted party between you (the admin or the robot) and the server of the infrastructure you need to access. To achieve this, when you use the bastion to connect to the server, there are two distinct ssh connections present at the same time:</p>
<blockquote>
<div><ul class="simple">
<li>The ingress ssh connection, between you and the bastion. For this connection your local private ssh key is used to authenticate yourself to the bastion</li>
<li>The egress ssh connection, between the bastion and the remote server you need to access. For this connection your bastion egress private ssh key (or a group egress private ssh key you're member of) is used to authenticate the bastion to the remote server</li>
</ul>
</div></blockquote>
<p>Those two connections are distinct, and the bastion logic merges those two so that you're under the impression that you're directly connected to the remote server. There is no dynamic port forwarding happening on the bastion to enable access to the remote server from your desktop, network-wise (which is what <code class="docutils literal"><span class="pre">JumpHost</span></code> does).</p>
<p>Using <code class="docutils literal"><span class="pre">ProxyCommand</span></code> with the bastion doesn't make sense because with this option, your local ssh client expects to talk the SSH dialect on the STDIN of the ProxyCommand you're giving, and it'll try to use your local SSH key to authenticate you through it, which won't work as it's only used for the ingress connection. However, when you use the usual bastion alias, in STDIN you have the remote server terminal directly, all the SSH stuff has already been done.</p>
<p>Attempting to summarize this a bit would be: <code class="docutils literal"><span class="pre">ProxyCommand</span></code> and <code class="docutils literal"><span class="pre">JumpHost</span></code> are useful when the server you're trying to connect to can't be accessed <em>network-wise</em> from where you stand, and needs to be accessed through some kind of proxy instead, where The Bastion's logic is to use two distinct SSH connections, and two distinct authentication phases, with two distinct SSH keys (yours for the ingress connection, and your bastion egress key for the egress connection).</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="plugins/group-owner/groupTransmitOwnership.html" class="btn btn-neutral" title="groupTransmitOwnership" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, OVHcloud.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.00.00',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>